name: 24/7 Stable SSH (tmate)

on:
  push:
    branches: [ "main" ]
  # यह हर 4 घंटे में अपने आप रीस्टार्ट होगा (240 मिनट के लिए)
  schedule:
    - cron: '0 */4 * * *' 
  # इसे आप Actions टैब से खुद भी चला सकते हैं
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    # आपका 240 मिनट (4 घंटे) का टाइमआउट
    timeout-minutes: 240 

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup tmate Session
        uses: mxschmitt/action-tmate@v3
        # 'limit-access-to-actor: false' ताकि आप बिना GitHub लॉगिन के भी कनेक्ट कर सकें
        with:
          limit-access-to-actor: false

      # यह लूप तब चलेगा अगर tmate किसी कारण से बैकग्राउंड में चला जाए
      - name: Keep Alive Loop
        run: |
          echo "Starting Keep Alive Loop for 235 minutes..."
          end=$((SECONDS + 235 * 60))
          while [ $SECONDS -lt $end ]; do
            echo "Runner Status: ACTIVE | Time: $(date)"
            # हर 5 मिनट में लॉग अपडेट करेगा
            sleep 300
          done
          echo "Timeout reached. The next scheduled job will start soon."
