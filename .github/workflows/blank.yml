name: 24/7 Keep Alive Runner

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  # Automatically triggers every 5 hours to ensure continuity
  schedule:
    - cron: '0 */5 * * *' 
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    # GitHub's maximum limit is 360 minutes (6 hours)
    timeout-minutes: 350 

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Keep Runner Active
        run: |
          # Start sshx in the background so the script continues
          curl -sSf https://sshx.io/get | sh -s run &
          
          echo "Starting your long-running process..."
          
          # Optional: Add your custom script here
          # Example: python my_script.py &
          
          # This loop keeps the runner alive for approximately 5.5 hours (330 minutes)
          # We stop at 330 minutes to prevent a hard timeout crash.
          end=$((SECONDS + 330 * 60))
          
          while [ $SECONDS -lt $end ]; do
            echo "Runner Status: Active | Time: $(date)"
            # Log an update every 5 minutes to keep the logs moving
            sleep 300
          done
          
          echo "Job finishing gracefully. The next scheduled cron will restart it shortly."
